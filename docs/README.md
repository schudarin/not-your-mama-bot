# Not Your Mama Bot

Саркастичный, грубый Telegram бот с личностью "девопс старой школы", который отвечает на упоминания, выполняет веб-поиск и генерирует ответы с помощью ИИ.

## Возможности

- **Саркастичная личность**: Отвечает грубыми, саркастичными комментариями в стиле девопс-инженера старой школы
- **Веб-поиск**: Выполняет поиск в интернете через DuckDuckGo при использовании ключевых слов типа "гугли", "найди", "поиск"
- **Настраиваемый стиль**: Изменяйте личность бота для каждого чата с помощью команды `/style`
- **Умные триггеры**: Отвечает на упоминания, ключевое слово "мразь" или прямые ответы
- **ИИ-функции**: Использует OpenAI GPT-4o-mini для умных ответов и сводок поиска

## Команды

- `/start` - Получить информацию о боте и инструкции по использованию
- `/style [текст]` - Показать/изменить личность бота для текущего чата
- `/ping` - Простая команда пинг для тестирования
- `/admin [add/remove/list] [ID]` - Управление администраторами (только для админов)
- `/update` - Обновить бота до последней версии (только для админов в личных сообщениях)

## Установка

### Требования

- Python 3.8+
- Telegram Bot Token (от [@BotFather](https://t.me/botfather))
- OpenAI API Key

### Установка

#### Быстрая установка (рекомендуется)

Запустите интерактивный установщик для Ubuntu/Linux:

```bash
chmod +x install.sh
./install.sh
```

Установщик автоматически:

- Проверит и установит зависимости
- Запросит необходимые данные с подробными инструкциями
- Выберет тип установки (локальная/системная/Docker)
- Настроит окружение

#### Ручная установка

1. Клонируйте репозиторий:

```bash
git clone <url-репозитория>
cd not-your-mama-bot
```

2. Установите зависимости:

```bash
pip install -r requirements.txt
```

3. Установите переменные окружения:

```bash
export TELEGRAM_BOT_TOKEN="ваш_токен_бота"
export OPENAI_API_KEY="ваш_openai_ключ"
export BOT_USERNAME="имя_вашего_бота"
```

4. Запустите бота:

```bash
python bot.py
```

### Развертывание на сервере

#### Автоматическое управление через systemd

1. Установите переменные окружения:

```bash
export TELEGRAM_BOT_TOKEN="ваш_токен_бота"
export OPENAI_API_KEY="ваш_openai_ключ"
export BOT_USERNAME="имя_вашего_бота"
```

2. Запустите скрипт установки:

```bash
sudo ./install-service.sh
```

3. Управление сервисом:

```bash
sudo systemctl status not-your-mama-bot    # Статус
sudo systemctl restart not-your-mama-bot   # Перезапуск
sudo systemctl stop not-your-mama-bot      # Остановка
sudo journalctl -u not-your-mama-bot -f    # Логи
```

#### Удаление бота

Для полного удаления бота с сервера:

```bash
sudo ./uninstall.sh
```

⚠️ **ВНИМАНИЕ**: Это действие необратимо! Будет удалено:

- Systemd сервис
- Пользователь botuser
- Все файлы бота
- Логи и конфигурации
- Docker контейнеры (если есть)

#### Обновление бота

**Автоматическое обновление:**

```bash
cd /opt/not-your-mama-bot
./update.sh
```

**Обновление через Telegram:**
Отправьте команду `/update` боту в личных сообщениях (требуются права администратора).

**Автоматические обновления:**

```bash
sudo ./setup-auto-update.sh
```

Выберите частоту обновлений: каждый час, каждые 6 часов, ежедневно или еженедельно.

### Настройка администраторов

1. **Автоматическое назначение супер-администратора:**

   - Первый пользователь, отправивший `/start` боту, автоматически становится супер-администратором
   - Супер-администратор не может быть удален

2. **Управление администраторами:**

   - `/admin` - показать список администраторов
   - `/admin add <ID>` - добавить администратора
   - `/admin remove <ID>` - удалить администратора

3. **Получение ID пользователя:**
   - ID автоматически логируется при использовании `/start`
   - Проверьте логи бота для получения ID

## Переменные окружения

- `TELEGRAM_BOT_TOKEN` - Ваш токен Telegram бота от BotFather
- `OPENAI_API_KEY` - Ваш ключ OpenAI API
- `BOT_USERNAME` - Имя пользователя вашего бота (без @)

## Использование

### В группах

- Упоминайте бота через `@имя_пользователя`
- Используйте слово "мразь" в сообщении
- Отвечайте на сообщения бота

### Веб-поиск

Запустите веб-поиск, используя ключевые слова:

- "гугли [запрос]"
- "найди [запрос]"
- "поиск [запрос]"
- "в интернете [запрос]"

### Настройка личности

Используйте команду `/style` для изменения личности бота в текущем чате:

```
/style Ты — вежливый и дружелюбный помощник
```

## Технические детали

- **Фреймворк**: python-telegram-bot
- **Поисковая система**: DuckDuckGo
- **ИИ-модель**: OpenAI GPT-4o-mini
- **Лимит сообщений**: 4000 символов на сообщение (лимит Telegram)

## Лицензия

Этот проект с открытым исходным кодом. Свободно модифицируйте и распространяйте.

## Участие в разработке

1. Форкните репозиторий
2. Создайте ветку для функции
3. Внесите изменения
4. Отправьте pull request

## Отказ от ответственности

Этот бот предназначен для развлечения и имеет саркастичный и грубый характер. Используйте ответственно и убедитесь, что он соответствует условиям использования Telegram и местным нормам.
